<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slug Generation Test</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Slug Generation Test</h1>
    <div id="results"></div>

    <script>
        const { createClient } = supabase;
        
        const supabaseClient = createClient(
            'https://kwozniwtygkdoagjegom.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3b3puaXd0eWdrZG9hZ2plZ29tIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc4Mzk3MjIsImV4cCI6MjA2MzQxNTcyMn0.hc51a_SvwYNUWfPmm2D3rriqGmE8LecInNmu5fa3tGk'
        );

        async function testSlugGeneration() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>ğŸ§ª Testing slug generation...</p>';

            try {
                // Test 1: Generate slug for Georgian text
                const { data: slug1, error: error1 } = await supabaseClient.rpc('generate_unique_slug', {
                    base_name: 'áƒ«áƒ áƒáƒ•áƒ˜áƒ¡ áƒ“áƒ˜áƒáƒ’áƒœáƒáƒ¡áƒ¢áƒ˜áƒ™áƒ'
                });

                if (error1) {
                    results.innerHTML += `<p>âŒ Error 1: ${error1.message}</p>`;
                } else {
                    results.innerHTML += `<p>âœ… Generated slug for "áƒ«áƒ áƒáƒ•áƒ˜áƒ¡ áƒ“áƒ˜áƒáƒ’áƒœáƒáƒ¡áƒ¢áƒ˜áƒ™áƒ": <strong>${slug1}</strong></p>`;
                }

                // Test 2: Generate another slug with same name (should get -1 suffix)
                const { data: slug2, error: error2 } = await supabaseClient.rpc('generate_unique_slug', {
                    base_name: 'áƒ«áƒ áƒáƒ•áƒ˜áƒ¡ áƒ“áƒ˜áƒáƒ’áƒœáƒáƒ¡áƒ¢áƒ˜áƒ™áƒ'
                });

                if (error2) {
                    results.innerHTML += `<p>âŒ Error 2: ${error2.message}</p>`;
                } else {
                    results.innerHTML += `<p>âœ… Generated second slug for "áƒ«áƒ áƒáƒ•áƒ˜áƒ¡ áƒ“áƒ˜áƒáƒ’áƒœáƒáƒ¡áƒ¢áƒ˜áƒ™áƒ": <strong>${slug2}</strong></p>`;
                }

                // Test 3: Test with English text
                const { data: slug3, error: error3 } = await supabaseClient.rpc('generate_unique_slug', {
                    base_name: 'Engine Diagnostics'
                });

                if (error3) {
                    results.innerHTML += `<p>âŒ Error 3: ${error3.message}</p>`;
                } else {
                    results.innerHTML += `<p>âœ… Generated slug for "Engine Diagnostics": <strong>${slug3}</strong></p>`;
                }

                // Test 4: Test with mixed Georgian and English
                const { data: slug4, error: error4 } = await supabaseClient.rpc('generate_unique_slug', {
                    base_name: 'BMW áƒ«áƒ áƒáƒ•áƒ˜áƒ¡ áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ˜'
                });

                if (error4) {
                    results.innerHTML += `<p>âŒ Error 4: ${error4.message}</p>`;
                } else {
                    results.innerHTML += `<p>âœ… Generated slug for "BMW áƒ«áƒ áƒáƒ•áƒ˜áƒ¡ áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ˜": <strong>${slug4}</strong></p>`;
                }

                results.innerHTML += '<p>ğŸ‰ Testing completed!</p>';

            } catch (error) {
                results.innerHTML += `<p>âŒ Unexpected error: ${error.message}</p>`;
            }
        }

        // Run test when page loads
        window.onload = testSlugGeneration;
    </script>
</body>
</html>